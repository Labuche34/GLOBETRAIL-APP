<%= link_to '⬅ Back', '#', onclick: 'window.history.back(); return false;', class: "back-button" %>

<div class="container col-12">
  <div class="row text-center my-3">
    <h1>Notes & Pictures</h1>
    <p>☀️ All your memories from <%= @travel.country %> ☀️</p>
  </div>

  <div class="row">
    <p><strong>Notes:</strong></p>
    <ul class="list-group">
      <% @travel.stops.each do |stop| %>
        <li class="list-group-item stop-card" style="font-size: 16px; font-weight: bold; margin-bottom: 8px; margin-top: 0; margin-right: 0; color: #219ebc;">
          <%= stop.city.capitalize %>

          <% if stop.notes.any? %>

              <% stop.notes.each do |note| %>
                  <%= note.content %>
                  <%= link_to stop_path(stop), data: { turbo_method: :delete, turbo_confirm: "Are you sure to delete this stop?" }, class: "btn btn-sm button ml-2 button-stop-card" do %>
                  <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z"/></svg>
                  <% end %>
              <% end %>
          <% else %>
            <span class="ms-2">No notes for this stop yet.</span>
          <% end %>
        </li>
      <% end %>
    </ul>
  </div>
  <br>

  <div class="row">
    <p><strong>Pictures:</strong></p>

    <div id="photosCarousel" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-inner">
        <% @stop.pictures.each do |picture| %>
          <% picture.photos.each_with_index do |photo, index| %>
            <div class="carousel-item <%= 'active' if index == 0 %>">
              <div class="image-container position-relative">
                <%= cl_image_tag photo.key, height: 300, width: 400, crop: :fill, class: "d-block mx-auto rounded", alt: "Photo #{index + 1}" %>
                <%= button_to picture_path(picture, photo.key), method: :delete, form: { data: { turbo_confirm: "Are you sure you want to delete this photo?" } }, class: "delete-photo-btn" do %>
                  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z"/></svg>
                <% end %>
              </div>

              <% if picture.description.present? %>
                <p class="mt-2 text-center"><%= picture.description %></p>
              <% end %>
            </div>

          <% end %>
        <% end %>
      </div>

      <button class="carousel-control-prev" type="button" data-bs-target="#photosCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>

      <button class="carousel-control-next" type="button" data-bs-target="#photosCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
 </div>
</div>
